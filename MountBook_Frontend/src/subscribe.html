<!doctype html>
<html>
    <head>
        <title>MountBook-Login</title>

        <!--CDN Vue-->
        <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
        <!--CDN Boostrap-->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
        <!--CDN Icone -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
        <!--CDN JQuery-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <!--Viewport per versione mobile-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!--Set logo-->
        <link rel="icon" href="../img/logo.png" type="image/icon type">
        <!--Google login API-->
        <script src="https://apis.google.com/js/platform.js" async defer></script>        
        <meta name="google-signin-client_id" content="595398968389-j7ao3ors9ged5r59lagmcacrbvnhdc6k.apps.googleusercontent.com">



    
    </head>
    <body>

        <div id="app" style="text-align: center;">

            <!--Logo-->
            <div style="text-align: center;">
                <img src="../img/logo.png" alt="MountBook" style=" height: 22%; width: 22%; margin-top: 1%;">
            </div>

            <!-- div login-->
            <div class="card" id="login-form" style="text-align: center; margin:10px auto; height: 30%; width: 20%; margin-top: 2%; min-width: 350px; max-width: 350px; min-height: 300px;">

                <article class="card-body">
                    <h4 class="card-title text-center mb-4 mt-1">Registrati</h4>
                    <hr>
                    <form>
                        <!-- Input username-->
                        <div class="input-group mb-3" >
                            <div class="input-group-prepend">
                            <span class="input-group-text" ><i class="bi bi-person-fill"></i></span>
                            </div>
                            <input id="username" type="text" class="form-control" placeholder="Username" aria-label="Username" aria-describedby="basic-addon1">
                        </div>

                         <!-- Input email-->
                         <div class="input-group mb-3" >
                            <div class="input-group-prepend">
                            <span class="input-group-text" ><i class="bi bi-envelope-fill"></i></span>
                            </div>
                            <input id="email"  type="text" class="form-control" placeholder="Email" aria-label="Email" aria-describedby="basic-addon1">
                        </div>

                        <!-- Input password-->
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                            <span class="input-group-text" ><i class="bi bi-key-fill"></i></span>
                            </div>
                            <input id="password" type="password" class="form-control" placeholder="Password" aria-label="Password" aria-describedby="basic-addon1">
                        </div>

                        <!--bottoni login-->
                        <div style="padding:2%; ">
                            <button type="button" class="btn btn-danger" @click="signUp()">Registrati</button><br>
                        </div> 
                    </form>
                </article>      
            </div>
        </div>
       
    </body>
    
    <script>
        $(document).ready(function(){
            //Azioni da eseguire al caricamento della pagina
        });

        //Definizione della componente di Vue.js
        var app = new Vue({

            el: '#app',

            data: {
                registerUrl: 'http://127.0.0.1:8081/api/auth/signup',
                jsn_customers:null,
                },
            methods:{

                signUp: function(){
                    
                    var username = document.getElementById("username").value;
                    var email = document.getElementById("email").value;
                    var password = document.getElementById("password").value;
                    

                    var tmp_json =JSON.stringify({
                        "username":username,
                        "email":email,
                        "password":password,
                        "role":["3"]
                    })

                    console.log(tmp_json);


                    $.ajax({
                        method: "POST",
                        url: app.registerUrl,
                        async:true,
                        crossDomain: true,
                        data:tmp_json,
                        contentType: "application/json",
                        success: function(result) {
                            console.log(result);
                            window.location.href = "login.html";

                        },
                        error: function(result){
                            console.log(result);
                            alert("Attenzione, i dati inseriti non hanno la forma corretta");
                        }
                    });

                },
                
            }
        })


    </script>
</html>